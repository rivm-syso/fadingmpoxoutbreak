(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     35345,        685]
NotebookOptionsPosition[     34770,        665]
NotebookOutlinePosition[     35310,        684]
CellTagsIndexPosition[     35267,        681]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "SetDirectory", "[", 
    "\"\<N:\\\\mpoxPUB1\\\\codeMathematica\\\\num250\\\\num250B\>\"", "]"}], 
   ";"}], "   "}]], "Input",
 CellChangeTimes->{{3.8728131373882513`*^9, 3.8728131609976754`*^9}, {
   3.8728912355587997`*^9, 3.8728912587307186`*^9}, {3.8728929671041574`*^9, 
   3.872892994574086*^9}, 3.872895427427899*^9, 3.8741021502081084`*^9, 
   3.8741030083682814`*^9, {3.8744016755681577`*^9, 3.874401677005664*^9}, 
   3.8754082511466036`*^9, {3.875428530290581*^9, 3.875428541775057*^9}, {
   3.877081037536296*^9, 3.877081038926927*^9}, {3.877607162872872*^9, 
   3.8776071637947593`*^9}, {3.8777372539487696`*^9, 
   3.8777372541050196`*^9}, {3.8778199619688797`*^9, 3.877819963047017*^9}, 
   3.88491482107006*^9, 3.892000040878908*^9, 3.892168630598544*^9, {
   3.8970054637810416`*^9, 3.89700549312237*^9}, 3.897005564711582*^9},
 ExpressionUUID -> "9a40a89c-f558-4db0-baed-fa14f57c5634"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", "CERTAIN"}]}]}]}]}]}]}], " ", 
    RowBox[{"PARAM", " ", "--"}], 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nmaxsim", "=", "10000"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"#simul", " ", "to", " ", "run"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ag", "=", "4"}], ";"}], "            ", 
   RowBox[{"(*", " ", 
    RowBox[{"#", " ", "sex", " ", "activity", " ", "groups"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mu", "=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"50", "*", "365"}], ")"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"50", "yrs", " ", "sex", " ", "active"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nini", "=", "250000"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"2.7", "%", " ", "of", " ", "15"}], "-", 
      RowBox[{"64", "yrs", " ", "men"}]}], ";"}], "*)"}], "  ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NGini", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{".451", ",", ".364", ",", ".179", ",", "0.006"}], "}"}], "*", 
      "Nini"}]}], ";"}], " ", 
   RowBox[{"(*", "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"oldVac", "=", "0.25"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "fraction", " ", "of", " ", "MSM", " ", "population", " ", "vaccinated", 
     " ", "in", " ", "past"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Izero", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"State0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "oldVac"}], ")"}], "*", "NGini"}], ",", "Izero", 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "3"}], "}"}], ",", "Izero", ",", 
       RowBox[{"oldVac", "*", "NGini"}], ",", "Izero", ",", "Izero", ",", 
       "Izero", ",", "Izero", ",", "Izero", ",", "Izero", ",", "Izero", " ", 
       ",", "Izero", ",", "Izero"}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"STATE", " ", "AT", " ", "t"}], "=", "0"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mud", "=", ".0004"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aM", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.1", ",", "0.2", ",", "  ", "0.7", ",", "  ", "0.7"}], "}"}],
       "/", "365"}]}], ";"}], "         ", 
   RowBox[{"(*", " ", 
    RowBox[{"#main", " ", 
     RowBox[{"partn", "/", "d"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aCd", "=", 
     RowBox[{"{", 
      RowBox[{"0.006", ",", ".044", ",", ".139", ",", "1.172"}], "}"}]}], 
    ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"#cas", "  ", 
     RowBox[{"partn", "/", "d"}]}], " ", "*)"}], "  ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uM", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "30"}], ",", 
       RowBox[{"1", "/", "15"}], ",", 
       RowBox[{"1", "/", "7"}], ",", 
       RowBox[{"1", "/", "7"}]}], "}"}]}], ";", "                  ", 
    RowBox[{"(*", " ", 
     RowBox[{"#", " ", "sex", " ", 
      RowBox[{"acts", " ", "/", "main"}], " ", 
      RowBox[{"partner", "/", "day"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"q", "=", 
     RowBox[{"{", 
      RowBox[{".60", ",", ".51", ",", ".54", ",", ".42"}], "}"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"fraction", " ", "msm", " ", "with", " ", "main", " ", "partn"}],
      " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dd", "[", "1", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", 
    RowBox[{
     RowBox[{"dd", "[", "2", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], ";", 
    RowBox[{
     RowBox[{"dd", "[", "3", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], ";", 
    RowBox[{
     RowBox[{"dd", "[", "4", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numpar", "=", 
     RowBox[{"{", "     ", 
      RowBox[{
      "1", " ", ",", "                 ", "2", " ", ",", 
       "                          ", "3", ",", "          ", "4", ",", 
       "       ", "5", ",", "         ", "6", ",", "             ", "7", ",", 
       "                 ", "8", "  ", ",", "       ", "9", "   ", ",", "  ", 
       "10", ",", "   ", "11", ",", "   ", "12", " ", ",", "   ", "13", ",", 
       "     ", "14", ",", "   ", "15", ",", " ", "16", ",", "  ", "17", ",", 
       "    ", "18", ",", "    ", "19", ",", "     ", "20", " ", ",", "     ",
        "21", ",", "        ", "22"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPName", "=", 
     RowBox[{"{", 
      RowBox[{
      "thetaRATE", ",", "infectiousTotal", ",", "betaS", ",", "ac4", ",", 
       "   ", "w1", ",", "epsilonM", ",", "epsilonC", ",", "vacRate", ",", 
       "v1", ",", "   ", "v2", ",", "zeta", ",", "tis1", ",", "tis2", ",", 
       "tis3", ",", "t1", ",", "t2", ",", "cas2", ",", "cas3", ",", "cas4", 
       ",", "casB2", ",", "casB3", ",", "casB4"}], "}"}]}], ";"}], "  ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fmin", "=", "    ", 
     RowBox[{"{", "     ", 
      RowBox[{
      "5", " ", ",", "                     ", "14", ",", 
       "                      ", "0.1", ",", "   ", "0.7", ",", "  ", ".15", 
       ",", "          ", ".1", ",", "            ", ".1", ",", "    ", 
       ".0003", ",", "   ", ".35", ",", ".10", ",", ".010", ",", "   ", "2", 
       ",", "      ", "2", ",", "         ", "2", " ", ",", "    ", "52", ",",
        "70", ",", "  ", ".0", ",", "    ", "0", ",", "       ", "0", ",", 
       "         ", "0", ",", "          ", "0", ",", "        ", "0"}], 
      "}"}]}], ";"}], "    ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fmax", "=", "    ", 
     RowBox[{"{", "     ", 
      RowBox[{
      "8", ",", "                      ", "28", ",", "                      ",
        "0.9", ",", "   ", "1.0", ",", "  ", ".70", ",", "          ", ".9", 
       ",", "            ", ".9", ",", "    ", ".0005", ",", "   ", ".50", 
       ",", ".20", ",", ".020", ",", "   ", "8", ",", "      ", "8", ",", 
       "         ", "8", ",", "     ", "62", ",", "80", ",", "  ", ".8", ",", 
       "   ", ".8", ",", "     ", ".8", ",", "      ", ".8", ",", "        ", 
       ".8", ",", "     ", ".8"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kpar", "=", 
     RowBox[{"Length", "[", "Fmin", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPName", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Latent period, days (1/theta)\>\"", ",", 
       "\"\<Infectious period (1/gamma+1/delta)\>\"", ",", "\"\<betaS\>\"", 
       ",", "\"\<ac4\>\"", ",", " ", 
       "\"\<Factor reducing transm from restrained w\>\"", ",", 
       "\"\<epsilonM\>\"", ",", "\"\<epsilonC\>\"", ",", 
       "\"\<Vaccination rate before 25July\>\"", ",", "\"\<v1\>\"", ",", " ", 
       "\"\<v2\>\"", ",", "\"\<zeta\>\"", ",", 
       "\"\<Days infectious not-restrained 1\>\"", ",", 
       "\"\<Days infectious not-restrained 2\>\"", ",", 
       "\"\<Days infectious not-restrained 3\>\"", ",", 
       "\"\<Day 1st change (t1)\>\"", ",", "\"\<Day 2nd change (t2)\>\"", 
       ",", "\"\<% reduction in # casual partners gr1&gr2, July\>\"", ",", 
       "\"\<% reduction in # casual partners gr3, July\>\"", ",", 
       "\"\<% reduction in # casual partners gr4, July\>\"", ",", 
       "\"\<% reduction in # casual partners gr1&gr2, June\>\"", ",", 
       "\"\<% reduction in # casual partners gr3, June\>\"", ",", 
       "\"\<% reduction in # casual partners gr4, June\>\""}], "}"}]}], ";"}],
    "  "}]}]], "Input",
 CellChangeTimes->{{3.872813176544587*^9, 3.8728131776227093`*^9}, {
   3.8728132296071844`*^9, 3.872813290919816*^9}, {3.872813327044899*^9, 
   3.8728133281073885`*^9}, {3.8728198206585116`*^9, 3.872819821658533*^9}, 
   3.872820131580782*^9, {3.872824763745864*^9, 3.8728247820743766`*^9}, {
   3.8728251038607855`*^9, 3.872825104142029*^9}, {3.8728251377208805`*^9, 
   3.8728251417990193`*^9}, 3.872825321586836*^9, 3.872825577327861*^9, {
   3.8728258357515135`*^9, 3.872825848173868*^9}, {3.8728261312484813`*^9, 
   3.8728261343734846`*^9}, {3.872826678729555*^9, 3.8728266793858175`*^9}, {
   3.8728268779248557`*^9, 3.872826881299862*^9}, {3.8728275751665707`*^9, 
   3.8728276168083086`*^9}, 3.8728277343932333`*^9, {3.8728289038449364`*^9, 
   3.872828911798077*^9}, {3.872828964268128*^9, 3.8728289669400063`*^9}, {
   3.872829228536149*^9, 3.872829232333107*^9}, 3.8728294112354927`*^9, {
   3.872829596951954*^9, 3.8728295971550837`*^9}, {3.872829755897916*^9, 
   3.8728297623979473`*^9}, {3.8728950782419395`*^9, 3.872895091242218*^9}, {
   3.8728975219523935`*^9, 3.872897530718029*^9}, {3.872910623259471*^9, 
   3.872910638228537*^9}, {3.872911193692048*^9, 3.872911206051448*^9}, {
   3.8729114938127513`*^9, 3.872911500172265*^9}, {3.8729152108267317`*^9, 
   3.8729152342017765`*^9}, 3.872915280483121*^9, {3.8729153364207263`*^9, 
   3.8729153367801094`*^9}, {3.872915736530776*^9, 3.872915739327655*^9}, {
   3.8729161124948235`*^9, 3.8729161159480124`*^9}, {3.8729171173251896`*^9, 
   3.872917123076047*^9}, {3.8729184664583807`*^9, 3.8729184796146593`*^9}, 
   3.8729186236438627`*^9, {3.8729225498866205`*^9, 3.87292258601256*^9}, 
   3.8729228490825787`*^9, {3.87292293496721*^9, 3.872922937920397*^9}, {
   3.872923033150547*^9, 3.8729230355724754`*^9}, {3.8729233139952993`*^9, 
   3.8729233665441465`*^9}, {3.872923521796771*^9, 3.8729235501724415`*^9}, {
   3.8729235845006404`*^9, 3.872923606266317*^9}, {3.8729236620177307`*^9, 
   3.872923670189619*^9}, {3.872923711160056*^9, 3.8729237117381697`*^9}, {
   3.8729244795104976`*^9, 3.8729244950113325`*^9}, {3.8729249089372163`*^9, 
   3.872924914077857*^9}, {3.8729250428549166`*^9, 3.8729250739331055`*^9}, {
   3.87292531413796*^9, 3.872925331171178*^9}, {3.872929260198579*^9, 
   3.8729292642923346`*^9}, {3.8729295206455455`*^9, 3.87292952155179*^9}, {
   3.8729297598393717`*^9, 3.8729297634956217`*^9}, {3.872929820639047*^9, 
   3.8729298235296817`*^9}, 3.872931926478117*^9, 3.8729322854642725`*^9, {
   3.872932740648068*^9, 3.8729327412261972`*^9}, {3.8729369976054153`*^9, 
   3.872937043888816*^9}, {3.873086649891841*^9, 3.8730866807362566`*^9}, 
   3.873086778765057*^9, 3.8730869566256404`*^9, {3.8730873625916305`*^9, 
   3.8730873718572783`*^9}, 3.8730881170438614`*^9, {3.8730892237226715`*^9, 
   3.87308928686746*^9}, {3.8730894032139187`*^9, 3.8730894133092523`*^9}, {
   3.873091461723619*^9, 3.8730914686142626`*^9}, {3.8730947845894055`*^9, 
   3.873094794651927*^9}, {3.87309498261734*^9, 3.8730949903048525`*^9}, {
   3.873095220370493*^9, 3.8730952294644403`*^9}, 3.8730954482529573`*^9, 
   3.8731025652305117`*^9, {3.873102624808753*^9, 3.873102625011885*^9}, 
   3.8731027707629194`*^9, {3.873103746408615*^9, 3.8731037473461137`*^9}, {
   3.873178003738472*^9, 3.873178004566601*^9}, {3.873178067286954*^9, 
   3.8731780696307125`*^9}, {3.873178897642516*^9, 3.8731789022363677`*^9}, {
   3.873179107930236*^9, 3.8731791114614906`*^9}, {3.8731791577775793`*^9, 
   3.8731791800744977`*^9}, 3.8731795640262957`*^9, {3.873179763407883*^9, 
   3.8731797830176754`*^9}, 3.8731801902746964`*^9, {3.8732399653727875`*^9, 
   3.8732399738740883`*^9}, {3.8732415616625547`*^9, 3.873241567443804*^9}, {
   3.8732428769869704`*^9, 3.873242901565617*^9}, {3.8732429329107485`*^9, 
   3.873242940755536*^9}, {3.873243069242672*^9, 3.8732431696050076`*^9}, {
   3.8732436461854568`*^9, 3.8732436974675183`*^9}, {3.8732502137373753`*^9, 
   3.8732502344249177`*^9}, {3.8732504514924393`*^9, 3.873250455883079*^9}, {
   3.8734128579373074`*^9, 3.8734128655921297`*^9}, {3.8734136397309227`*^9, 
   3.873413644552936*^9}, {3.8734159184474936`*^9, 3.873415953712742*^9}, {
   3.873415985071817*^9, 3.8734160144934587`*^9}, 3.8734315267820063`*^9, {
   3.8734424537874117`*^9, 3.87344245531868*^9}, {3.8734426816488132`*^9, 
   3.873442716914668*^9}, {3.8734428092321696`*^9, 3.873442829677226*^9}, {
   3.8734434725099893`*^9, 3.8734434771194334`*^9}, {3.8734475204186554`*^9, 
   3.8734475327287116`*^9}, {3.873448064159957*^9, 3.873448088426982*^9}, {
   3.8734481803252397`*^9, 3.8734481826065063`*^9}, {3.8734483221227617`*^9, 
   3.8734483273259077`*^9}, {3.873449968821948*^9, 3.8734499885230045`*^9}, {
   3.873499718898744*^9, 3.8734997944935966`*^9}, {3.8734998361503706`*^9, 
   3.8734998382597694`*^9}, {3.873499882775894*^9, 3.873499904854474*^9}, 
   3.8735004595054474`*^9, {3.87350083785059*^9, 3.8735008469236307`*^9}, {
   3.873506743966319*^9, 3.8735067464819565`*^9}, {3.873506945059554*^9, 
   3.8735069766528387`*^9}, 3.873507087021467*^9, 3.873507572113352*^9, {
   3.873589961327752*^9, 3.8735899669994726`*^9}, 3.873590380204734*^9, {
   3.8735904397213087`*^9, 3.873590461315057*^9}, {3.873591164626263*^9, 
   3.8735911700326185`*^9}, 3.8735912265036783`*^9, {3.8735912836613555`*^9, 
   3.873591309849224*^9}, 3.8735918943183947`*^9, {3.873591979489394*^9, 
   3.873591979768394*^9}, 3.8735920297878227`*^9, {3.873592343579005*^9, 
   3.8735923458660307`*^9}, {3.8735930623267317`*^9, 3.8735930656128063`*^9}, 
   3.8735937965442014`*^9, {3.8735938407543287`*^9, 3.873593976590025*^9}, {
   3.873594218471525*^9, 3.8735943281131935`*^9}, 3.8735996238325305`*^9, {
   3.8736001549864225`*^9, 3.873600167159523*^9}, 3.873600316275214*^9, {
   3.873601393525585*^9, 3.8736014863101*^9}, {3.8737141958060465`*^9, 
   3.873714200149787*^9}, {3.873714546927368*^9, 3.873714548077372*^9}, {
   3.8737147134617105`*^9, 3.873714757840744*^9}, {3.8737151936958804`*^9, 
   3.87371523474294*^9}, 3.873716022700984*^9, 3.873717519842105*^9, {
   3.8737179260212*^9, 3.8737179292132163`*^9}, {3.8737194009364*^9, 
   3.873719424655296*^9}, 3.873720475992914*^9, {3.873727799916856*^9, 
   3.8737278016299376`*^9}, 3.8737279419988933`*^9, {3.873766252679696*^9, 
   3.8737662582596073`*^9}, {3.8737663977170644`*^9, 
   3.8737663981980686`*^9}, {3.873768381467885*^9, 3.8737683851397905`*^9}, 
   3.8737685035243382`*^9, 3.8737685433174105`*^9, {3.8737771099251337`*^9, 
   3.873777143128476*^9}, {3.8737777252695303`*^9, 3.8737777611402197`*^9}, {
   3.8737778392526884`*^9, 3.8737778469074793`*^9}, 3.873778591081155*^9, {
   3.873779122140867*^9, 3.8737791311548834`*^9}, {3.8737795672373676`*^9, 
   3.873779574174878*^9}, 3.8737803876536303`*^9, {3.8737842040906625`*^9, 
   3.8737842052106714`*^9}, {3.873784261491826*^9, 3.8737842706913514`*^9}, {
   3.8737843487090397`*^9, 3.873784356923894*^9}, 3.873784822767413*^9, 
   3.87378527483454*^9, {3.8737878112913237`*^9, 3.8737878197288713`*^9}, {
   3.873788537759413*^9, 3.873788538805423*^9}, {3.8737886296162453`*^9, 
   3.8737886311262536`*^9}, {3.8737893832296925`*^9, 3.873789383467705*^9}, 
   3.873789475847742*^9, {3.873790863560887*^9, 3.873790868813796*^9}, {
   3.8737913631129446`*^9, 3.8737913934649825`*^9}, 3.8737914296740327`*^9, {
   3.8737915027339907`*^9, 3.873791509827009*^9}, {3.8737919675351677`*^9, 
   3.8737919682201624`*^9}, {3.873847151018326*^9, 3.873847153799593*^9}, {
   3.87384812541626*^9, 3.873848136166355*^9}, {3.873851314733358*^9, 
   3.8738513268585176`*^9}, {3.873857901275559*^9, 3.8738579020880623`*^9}, 
   3.873859058847786*^9, 3.873859837889662*^9, {3.8738600502614965`*^9, 
   3.87386007405903*^9}, {3.873860898386834*^9, 3.8738609283096952`*^9}, 
   3.8738613608544655`*^9, 3.873863741464834*^9, {3.87386397593637*^9, 
   3.873863981295762*^9}, {3.873877387472299*^9, 3.8738774006443853`*^9}, {
   3.873878319945157*^9, 3.8738783244295406`*^9}, {3.8738793170339355`*^9, 
   3.873879319658941*^9}, {3.8738921071385937`*^9, 3.8738921124198523`*^9}, {
   3.873892522600646*^9, 3.873892522819398*^9}, {3.8738926203692417`*^9, 
   3.8738926212449584`*^9}, {3.8739287600083623`*^9, 3.873928775511198*^9}, {
   3.8739293195764627`*^9, 3.873929343983195*^9}, {3.8739307086375613`*^9, 
   3.8739307212469635`*^9}, {3.873931247805075*^9, 3.873931257087764*^9}, {
   3.873931746547583*^9, 3.873931750375713*^9}, 3.873932172679907*^9, {
   3.8739323402053337`*^9, 3.873932351814726*^9}, {3.873935397852564*^9, 
   3.873935401822214*^9}, 3.8739354507214003`*^9, 3.873935946694687*^9, 
   3.8739398950222154`*^9, 3.873941696407549*^9, {3.8739418119902754`*^9, 
   3.873941815678727*^9}, {3.8739451629189634`*^9, 3.8739451816718545`*^9}, {
   3.873945218533188*^9, 3.8739452401455216`*^9}, {3.8739452914292154`*^9, 
   3.8739453019013414`*^9}, {3.873947679020116*^9, 3.873947727473956*^9}, {
   3.8739478803085117`*^9, 3.873947917811449*^9}, {3.8739479483441935`*^9, 
   3.8739479978164744`*^9}, {3.873948740113453*^9, 3.8739487799434476`*^9}, 
   3.873948912089342*^9, {3.87394895280211*^9, 3.873948953145859*^9}, {
   3.8739512915364275`*^9, 3.873951309256212*^9}, 3.873951508487952*^9, {
   3.873951774567304*^9, 3.8739517878493323`*^9}, {3.874038658949703*^9, 
   3.874038660152836*^9}, 3.874038996362146*^9, {3.874039439175129*^9, 
   3.874039442237645*^9}, {3.8740402104315577`*^9, 3.874040211087817*^9}, {
   3.8740406267465363`*^9, 3.8740406486855254`*^9}, {3.8740410673164897`*^9, 
   3.874041068957116*^9}, {3.8741016894163556`*^9, 3.87410168980698*^9}, {
   3.8741018879409513`*^9, 3.874101889112827*^9}, {3.8741019447105722`*^9, 
   3.874101958867675*^9}, {3.874102202587248*^9, 3.8741023171618586`*^9}, {
   3.874102373635661*^9, 3.8741024527681875`*^9}, {3.8741024866762366`*^9, 
   3.8741028830458*^9}, {3.874102944784992*^9, 3.8741029678820353`*^9}, {
   3.8741030214637513`*^9, 3.874103034903014*^9}, {3.8741030746263237`*^9, 
   3.874103075704457*^9}, {3.874116037660383*^9, 3.874116039457265*^9}, {
   3.8741297640095696`*^9, 3.8741297648067245`*^9}, {3.874244678153515*^9, 
   3.874244686685734*^9}, {3.8742447538458056`*^9, 3.874244762815975*^9}, {
   3.8742464067344117`*^9, 3.874246438844857*^9}, {3.874401259392915*^9, 
   3.8744012722836905`*^9}, 3.8744013329093156`*^9, {3.874401367394029*^9, 
   3.874401489520037*^9}, {3.874409579864817*^9, 3.8744095872554917`*^9}, {
   3.874420207156645*^9, 3.8744202082191453`*^9}, {3.874457390841628*^9, 
   3.874457413513855*^9}, {3.8744574551394377`*^9, 3.874457473889683*^9}, {
   3.8744575347185354`*^9, 3.8744575585469303`*^9}, {3.8744581235436134`*^9, 
   3.8744581284029946`*^9}, 3.8744584552343163`*^9, {3.874458768255511*^9, 
   3.8744587780359645`*^9}, {3.874459120175259*^9, 3.8744591219408903`*^9}, {
   3.8744593879168463`*^9, 3.874459409073717*^9}, {3.8744601997081385`*^9, 
   3.8744602180987835`*^9}, {3.874498023019535*^9, 3.8744980247873726`*^9}, 
   3.874498394558285*^9, {3.8744995124916086`*^9, 3.874499513537614*^9}, {
   3.8745021757277365`*^9, 3.8745021821340427`*^9}, {3.8745364066026373`*^9, 
   3.8745364134413233`*^9}, {3.8745370438132954`*^9, 
   3.8745370701082554`*^9}, {3.874554371916012*^9, 3.8745544942461333`*^9}, {
   3.8745545409500923`*^9, 3.87455454120009*^9}, {3.874556574138996*^9, 
   3.8745565890452757`*^9}, 3.8745569793498015`*^9, {3.874562662844742*^9, 
   3.874562692503009*^9}, {3.8745648530714784`*^9, 3.8745648822455683`*^9}, {
   3.874564915793888*^9, 3.8745649755159707`*^9}, {3.8745741650857573`*^9, 
   3.8745742040708733`*^9}, 3.8745742710880356`*^9, {3.8745750343524356`*^9, 
   3.8745750605879507`*^9}, 3.87462245100045*^9, {3.8746449509608545`*^9, 
   3.874644973916331*^9}, {3.8747335863733196`*^9, 3.8747335941856356`*^9}, {
   3.874735796290228*^9, 3.8747357975407257`*^9}, 3.8747430085996027`*^9, {
   3.8748941872092905`*^9, 3.8748942587577267`*^9}, 3.874897229242675*^9, {
   3.8749112925886784`*^9, 3.874911294745338*^9}, {3.874915064568298*^9, 
   3.874915114318406*^9}, {3.874929496975711*^9, 3.8749294972413363`*^9}, {
   3.8752281810371532`*^9, 3.875228198006956*^9}, {3.8753601682924595`*^9, 
   3.87536019137063*^9}, 3.875360743371966*^9, 3.8753608160769033`*^9, {
   3.8753611401885157`*^9, 3.875361170110529*^9}, {3.8753617025225215`*^9, 
   3.8753617349595394`*^9}, {3.875361804802451*^9, 3.875361810459414*^9}, {
   3.875361907834528*^9, 3.8753620387565713`*^9}, {3.8754011847397776`*^9, 
   3.8754013570680323`*^9}, {3.875401466019659*^9, 3.8754014796130743`*^9}, {
   3.875401600361554*^9, 3.875401646096349*^9}, {3.875401767112756*^9, 
   3.8754017851595354`*^9}, {3.8754025408050685`*^9, 
   3.8754026159009542`*^9}, {3.875403945886798*^9, 3.8754039635909147`*^9}, {
   3.8754040037165976`*^9, 3.8754040283731537`*^9}, {3.8754045853116736`*^9, 
   3.8754046197327704`*^9}, {3.8754046807472744`*^9, 
   3.8754046988407526`*^9}, {3.875408257302882*^9, 3.875408257740384*^9}, 
   3.8754085760977325`*^9, {3.8754268361919994`*^9, 3.8754268806631017`*^9}, {
   3.875431747577043*^9, 3.875431759327781*^9}, {3.875455379701866*^9, 
   3.875455405921152*^9}, {3.8754562498132305`*^9, 3.8754562734696865`*^9}, {
   3.8754981815907717`*^9, 3.8754981823407784`*^9}, {3.875501505228339*^9, 
   3.875501527338999*^9}, {3.8755025754232655`*^9, 3.8755025849702225`*^9}, {
   3.8755031998186865`*^9, 3.87550322860126*^9}, 3.8755037324586573`*^9, {
   3.8755127209249864`*^9, 3.875512721471866*^9}, {3.875519816514944*^9, 
   3.875519838999716*^9}, {3.875519949098499*^9, 3.8755199832407827`*^9}, {
   3.8755205851898527`*^9, 3.8755206027847776`*^9}, {3.87552084195078*^9, 
   3.8755208427485504`*^9}, 3.875521601661255*^9, 3.8755216371619363`*^9, {
   3.8755231757501574`*^9, 3.8755231764532804`*^9}, {3.8755235853013525`*^9, 
   3.8755236980240183`*^9}, 3.8755243552140117`*^9, 3.8755281405511737`*^9, {
   3.8756657098459187`*^9, 3.8756657520181637`*^9}, {3.8756657881122217`*^9, 
   3.875666003412691*^9}, {3.875666752127138*^9, 3.8756667562678022`*^9}, {
   3.8757074987432165`*^9, 3.875707522415303*^9}, {3.875707600432415*^9, 
   3.8757076161056004`*^9}, {3.875749915639279*^9, 3.8757499254831133`*^9}, {
   3.875751573090433*^9, 3.8757515993895593`*^9}, {3.875753917108588*^9, 
   3.875753936390509*^9}, {3.8757555443752317`*^9, 3.8757556004547243`*^9}, {
   3.875755912704168*^9, 3.875755913110428*^9}, 3.8757564851737633`*^9, 
   3.8757569861220436`*^9, {3.875759467792562*^9, 3.8757594683863125`*^9}, 
   3.875759546828946*^9, 3.875765103795962*^9, {3.8757718553376265`*^9, 
   3.8757718629314423`*^9}, {3.8757724983229823`*^9, 
   3.8757725273388577`*^9}, {3.875781759343148*^9, 3.8757818072195635`*^9}, {
   3.8757856226005135`*^9, 3.875785663194805*^9}, {3.875786901731257*^9, 
   3.875786951467825*^9}, 3.875792092852088*^9, {3.876384775088895*^9, 
   3.8763847806677647`*^9}, {3.87638486956094*^9, 3.876385025430933*^9}, {
   3.876385755934682*^9, 3.8763857565596895`*^9}, {3.8763860916337886`*^9, 
   3.876386100477605*^9}, {3.8763868602014914`*^9, 3.8763868909217153`*^9}, {
   3.8763912441691957`*^9, 3.8763912600287056`*^9}, {3.8763932810282836`*^9, 
   3.8763932899346094`*^9}, {3.8764037939298887`*^9, 
   3.8764037955705395`*^9}, {3.8764038768223677`*^9, 3.876403896338723*^9}, {
   3.876404600010151*^9, 3.876404601244532*^9}, {3.8764046551356306`*^9, 
   3.876404687855087*^9}, {3.876404723152753*^9, 3.876404750918997*^9}, {
   3.8764048411740932`*^9, 3.876404841986599*^9}, {3.876405325255475*^9, 
   3.876405325677354*^9}, {3.8764053628818984`*^9, 3.8764053964290667`*^9}, {
   3.8764470898940334`*^9, 3.8764470960973725`*^9}, {3.8764477315876846`*^9, 
   3.876447734197085*^9}, {3.8764737300163603`*^9, 3.8764737315476236`*^9}, {
   3.876473775438631*^9, 3.8764737928762827`*^9}, {3.8764742700945463`*^9, 
   3.8764744222764854`*^9}, {3.8764838302169847`*^9, 3.8764838610778112`*^9}, 
   3.8764868975611076`*^9, {3.876487651776162*^9, 3.8764876761984043`*^9}, {
   3.876488834651373*^9, 3.8764888738558726`*^9}, 3.876489237506525*^9, {
   3.876489875001824*^9, 3.876489875298696*^9}, {3.8765271725600643`*^9, 
   3.876527175372589*^9}, {3.8765272921885624`*^9, 3.876527292813567*^9}, {
   3.876562845362439*^9, 3.876562856018783*^9}, {3.8766443645868206`*^9, 
   3.87664440238554*^9}, {3.876644477560911*^9, 3.876644509593713*^9}, {
   3.876644544017128*^9, 3.8766445476890182`*^9}, {3.8766446045190983`*^9, 
   3.8766446327231874`*^9}, {3.8766475064966917`*^9, 
   3.8766475176217885`*^9}, {3.8766475710755825`*^9, 
   3.8766475736224823`*^9}, {3.8766481889052353`*^9, 3.87664818928024*^9}, {
   3.876701661452776*^9, 3.8767016846093273`*^9}, {3.876705410117591*^9, 
   3.8767054203676777`*^9}, {3.876705542417001*^9, 3.876705560010907*^9}, {
   3.8767056206222196`*^9, 3.876705722638733*^9}, {3.8767057560296445`*^9, 
   3.8767057565765295`*^9}, {3.876709017257678*^9, 3.876709055368026*^9}, {
   3.876709756463129*^9, 3.876709772791772*^9}, {3.876711030137393*^9, 
   3.876711045715645*^9}, {3.876722038713281*^9, 3.8767220406976624`*^9}, 
   3.8767298029102545`*^9, {3.8767305480766296`*^9, 3.876730549373517*^9}, 
   3.8767306891433744`*^9, {3.876730772634416*^9, 3.876730792119094*^9}, {
   3.8767308705624094`*^9, 3.876730874265567*^9}, 3.876831893708499*^9, 
   3.8768327529805307`*^9, {3.876834811303217*^9, 3.87683481163134*^9}, {
   3.8769216324239144`*^9, 3.876921639502098*^9}, 3.876921747552056*^9, {
   3.876921923462616*^9, 3.876921923837612*^9}, {3.8769234101718445`*^9, 
   3.8769234196094403`*^9}, 3.8769253268470945`*^9, {3.8769311112346478`*^9, 
   3.876931111828405*^9}, {3.876978230548428*^9, 3.876978233142208*^9}, {
   3.8769782933154907`*^9, 3.876978441525525*^9}, {3.8769784799008656`*^9, 
   3.876978840992647*^9}, {3.876978885477766*^9, 3.8769789215270915`*^9}, {
   3.8769822948608246`*^9, 3.87698231089222*^9}, 3.876983438436702*^9, 
   3.8769841564124384`*^9, {3.877606374365699*^9, 3.8776064002107797`*^9}, {
   3.8776479795250463`*^9, 3.8776479969784327`*^9}, {3.877648058494978*^9, 
   3.8776480671982365`*^9}, {3.8776481264976*^9, 3.87764816507818*^9}, {
   3.877697818164769*^9, 3.8776978244617376`*^9}, {3.8776978673061333`*^9, 
   3.877697867978015*^9}, {3.8783424279431305`*^9, 3.8783424387088046`*^9}, {
   3.878342949623307*^9, 3.878342971998392*^9}, {3.8783430522174673`*^9, 
   3.8783430562331123`*^9}, {3.8783454736603193`*^9, 
   3.8783454745821924`*^9}, {3.878363907968688*^9, 3.8783639227316294`*^9}, {
   3.8783650659352217`*^9, 3.878365066731227*^9}, {3.8916537106959534`*^9, 
   3.891653798827089*^9}, 3.8916550973961563`*^9, 3.8916579157824106`*^9, 
   3.8970055329522543`*^9},
 ExpressionUUID -> "c8160a2b-fa5c-4a04-9143-85300fb257c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", "GENERATE"}]}]}]}]}], " ", "UNCERT", " ", "PARAM", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"upAllMat", "=", 
     RowBox[{"Array", "[", 
      RowBox[{"upAll", ",", 
       RowBox[{"{", 
        RowBox[{"nmaxsim", ",", "Kpar"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xx", "=", 
     RowBox[{"Range", "[", "nmaxsim", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"increment", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Fmax", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", 
           RowBox[{"Fmin", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", "nmaxsim"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"correction", "=", 
        RowBox[{"increment", "/", "10"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"intervMin", "=", 
        RowBox[{
         RowBox[{"Fmin", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"xx", "-", "1"}], ")"}], "*", "increment"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"intervMax", "=", 
        RowBox[{
         RowBox[{"Fmin", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "+", 
         RowBox[{"xx", "*", "increment"}], "-", "correction"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"randIndex", "=", 
        RowBox[{"RandomSample", "[", 
         RowBox[{"Range", "[", "nmaxsim", "]"}], "]"}]}], ";", "    ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"PermutationList", "[", 
          RowBox[{"RandomPermutation", "[", "nmaxsim", "]"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"upAll", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"intervMax", "[", 
               RowBox[{"[", 
                RowBox[{"randIndex", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", 
              RowBox[{"intervMin", "[", 
               RowBox[{"[", 
                RowBox[{"randIndex", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"RandomReal", "[", "]"}]}], "+", 
           RowBox[{"intervMin", "[", 
            RowBox[{"[", 
             RowBox[{"randIndex", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nmaxsim"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "Kpar"}], "}"}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.874575043243077*^9, 3.874575045586832*^9}, {
  3.875666016381548*^9, 3.8756660220378494`*^9}},
 ExpressionUUID -> "3707f216-c080-4aa0-aa45-89e946905d65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
    RowBox[{"SAVE", "**", "**"}], "*", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**"}]}], "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Save", "[", 
     RowBox[{"\"\<param\\\\paramCertain\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "nmaxsim", ",", "ag", ",", "Kpar", ",", "mu", ",", "Nini", ",", 
        "NGini", ",", "oldVac", ",", "aM", ",", "aCd", ",", "uM", ",", "dd", 
        ",", "q", ",", "mud", ",", "Izero", ",", "State0", ",", "UPName"}], 
       "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Save", "[", 
     RowBox[{"\"\<param\\\\paramUncert\>\"", ",", 
      RowBox[{"{", "upAllMat", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"**", "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
               "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}],
        "**"}], "**"}], "**"}], "*****)"}]}]}]], "Input",
 CellChangeTimes->{{3.874101969697466*^9, 3.874102045311002*^9}, {
   3.874102331381606*^9, 3.8741023508663926`*^9}, {3.8741023811831894`*^9, 
   3.8741023816519403`*^9}, {3.874102849324901*^9, 3.8741028497633553`*^9}, {
   3.874103086532864*^9, 3.8741030905956397`*^9}, 3.8741032698635507`*^9, 
   3.8745742410709505`*^9, {3.874574273259931*^9, 3.8745742798224287`*^9}, {
   3.8745750519620757`*^9, 3.8745750547441883`*^9}, {3.8754015252690496`*^9, 
   3.8754015355657206`*^9}, {3.875401656486862*^9, 3.8754016801272545`*^9}, {
   3.87566598422502*^9, 3.8756659868031664`*^9}, {3.876646000129753*^9, 
   3.876646027270616*^9}, 3.876646059427145*^9, 3.8766483055833483`*^9, {
   3.8769216512834463`*^9, 3.876921684925001*^9}, {3.8769217919444304`*^9, 
   3.8769217996007266`*^9}, {3.876921917196931*^9, 3.876921919743826*^9}, {
   3.876931120250352*^9, 3.8769311382036295`*^9}},
 ExpressionUUID -> "a3774a09-b45d-479d-aad1-bd084ec149b2"]
},
WindowSize->{1418, 597},
WindowMargins->{{17, Automatic}, {60, Automatic}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PrintingMargins"->{{56.6875, 56.6875}, {54., 54.}}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb",
ExpressionUUID -> "6a68471e-0eb5-444c-b01d-07daaf20bc5f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 955, 17, 30, "Input"],
Cell[1503, 39, 27140, 458, 525, "Input"],
Cell[28646, 499, 3499, 100, 202, "Input"],
Cell[32148, 601, 2618, 62, 88, "Input"]
}
]
*)

